<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8">
<title>範例</title>

<style>
body {
	background: var(--bg-color);
	color: var(--fg-color);
}


.dark {
	--bg-color: #333;
	--fg-color: #eee;
}

.light {
	--bg-color: #eee;
	--fg-color: #333;
}

</style>

</head>
<body>


<h1>首頁</h1>
<p>內容</p>

<button id="BtnSwitchTheme">模式切換</button>

<script>
;(function() {
	var last_theme_fallback = 'light';

	function last_theme_get () {
		var last_theme;
		try {
			last_theme = localStorage.getItem('theme');

			//https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Error
			//throw new Error('Whoops!');
		} catch (err) {
			last_theme = last_theme_fallback;
		}

		return last_theme;
	}

	//theme = last_theme_get();



	function last_theme_set (new_theme) {
		last_theme_fallback = new_theme;

		try {
			localStorage.setItem('theme', new_theme);
		} catch (err) {
			//last_theme_fallback = new_theme;
		}

		return last_theme_fallback;
	}


	//last_theme_set('light');
	//console.log(last_theme_get());

	//last_theme_set('dark');
	//console.log(last_theme_get());


	function page_theme_set (new_theme) {
		if (document.body.className !== new_theme) {
			document.body.className = new_theme;
		}
	}

	function preferred_theme_set(new_theme) {
		last_theme_set(new_theme);
		page_theme_set(new_theme);
	}

	function preferred_theme_switch() {
		var new_theme;
		if (last_theme_get() === 'light') {
			new_theme = 'dark';
		} else {
			new_theme = 'light';
		}
		preferred_theme_set(new_theme);
	}

	function preferred_theme_last() {

		preferred_theme_set(last_theme_get());

	}


	document.getElementById('BtnSwitchTheme').addEventListener('click', function (e) {
		preferred_theme_switch();

	});

	preferred_theme_last();

})();
</script>




</body>
</html>
